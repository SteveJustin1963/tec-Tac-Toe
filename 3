variable Board
variable Round

: InitializeBoard ( Initialize the board )
    1 10 1 do
        i 2 * Board +! 
    loop ;

: UpdateBoard ( Update the board: R N -- )
    Round @ 3 * Board +! ;

: PrintBoard ( Print the board )
    0 3 0 do
        i 3 * 0 do
            i j + 3 * Board + @ . space
        loop
        cr
    loop ;

: CheckWinner ( Check winner: R -- F )
    Round ! 0
    0 3 0 do
        i 3 * 0 do
            i j + 3 * Board + @ Round @ = if 1+ else 0 then Round +!
        loop
    loop
    Round @ 3 = ;

: PlayRound ( Play round: N -- )
    UpdateBoard PrintBoard
    CheckWinner if
        cr ." WE HAVE A WINNER!" cr exit
    then ;

: RandomMove ( Random move )
    begin
        9 random 1+ dup CheckWinner 0= and
    until
    PlayRound ;

: UserMove ( User move )
    begin
        cr ." ENTER YOUR MOVE (1-9): " decimal accept 48 - dup CheckWinner 0=
    until
    PlayRound ;

: Main ( Main )
    InitializeBoard PrintBoard
    begin
        UserMove 120
        RandomMove 111
        CheckWinner 0=
    until ;
